GEE/GOM 传奇脚本开发助手
功能概述
专为GOM/GEE等多引擎传奇服务端脚本开发者设计的VSCode扩展，集成了从编码、调试到管理的完整工具链，让繁琐的脚本开发变得轻松高效。

QQ: 524310906 1号,  加QQ 获取功能体验
交流群: 430308386

语法高亮：基于语义的智能语法着色、代码错误检查和智能提示
命令补全：自动补全中英文脚本命令，支持@变量提示、双反引号代码模板和参数占位符
悬浮提示：鼠标悬停显示命令说明、参数格式、<$常量>、[@标签]和地图参数说明
大纲导航：自动提取[标签]形成文档大纲，支持快速定位、段落折叠和结构预览
路径补全：自动提示脚本文件路径
一键折叠：快速折叠/展开所有[@标签]代码段落，提升大文件浏览效率，保持代码结构清晰
一键重载：快速执行重载QManage、QFunction、NPC、爆率、Robot、数据等命令，立即生效
常用文件：快速打开QManage、QFunction、Merchant、MapInfo等13个核心配置文件，一键直达
符号大全：箭头、几何、数学、序号、货币、假名等12类特殊符号库，分类浏览一键插入
颜色管理：可视化显示彩色方块预览颜色效果，快速插入FCOLOR、SCOLOR、AUTOCOLOR代码，支持颜色面板选择
全局搜索：实时搜索全工程脚本内容，支持关键词过滤、点击跳转文件行和进度显示
变量占用：扫描A、G、I、S、N、U、T、P、D、M、计时器、物品S\N扩展、双击触发、自定义等所有变量使用情况
视图转换：精简模式隐藏配置和生成文件，普通模式显示全部文件，智能识别项目结构
地图编辑：可视化查看地图文件，显示阻挡信息、资源使用情况，支持编辑修改和自动保存更新
文件备注：支持文件夹与常用文件备注，右键文件名进行备注设置
快速注释：使用快捷键ctrl+/ 可快速注释代码，支持批量多行操作
数据库查询：支持SQLite/Access查看物品、怪物、技能数据库，支持类型筛选、职业筛选、实时搜索、点击插入，
智能跳转：选中文本循环转换<$STR>四种格式，无选中时智能跳转#CALL、MAP、GM命令等20+种文件场景，支持自动创建缺失文件
变量转换：普通文本与<$STR>、<$STR(S$)>、<$STR(N$)>四种格式循环转换，支持粘贴上次结果
变量追踪：跨文件深度追踪变量引用关系链，分析复杂变量依赖和调用路径
参数补全：自动提示命令的完整参数格式，支持文件路径自动补全和智能提示
自动重载：保存QM、QF、NPC、爆率、Robot等文件时自动重载对应脚本，支持防抖控制
代码生成：可视化拖拽设计对话框布局，实时获取坐标、自动生成脚本代码和预览效果


万能F1助手 - 智能跳转与转换
智能文本转换（选中文本后按F1）
- 选中任意文本，按F1键可在4种模式间循环切换：
  - 普通文本 → <$STR(文本)>
  - <$STR(文本)> → <$STR(S$文本)>
  - <$STR(S$文本)> → <$STR(N$文本)>
  - <$STR(N$文本)> → 回到普通格式
- 小技巧：按Ctrl+F1可快速粘贴上一次的转换结果

一键智能跳转（无选中文本时按F1）
根据当前光标所在行的内容，自动识别并跳转到相关文件：
- 脚本调用跳转：从 CALL [\路径] @标签 直接跳转到对应脚本文件的标签位置
- NPC配置跳转：在Merchant.txt中跳转到对应的NPC脚本文件
- 怪物爆率跳转：在Mongen.txt中跳转到怪物的爆率文件
- 相对路径跳转：从..\QuestDiary\xxx.txt跳转到实际文件
- 地图相关跳转：从MAP/MAPMOVE命令跳转到Mongen.txt中的对应地图配置
- 定时器跳转：在AutoRunRobot.txt中跳转到RobotManage.txt的定时器标签
- 全局功能跳转：从GMEXECUTE/HCALL命令跳转到QManage.txt
- 定时器开关跳转：从SetOnTimer/SetOffTimer跳转到QManage.txt的对应定时器标签（自动创建缺失标签）
- 系统消息跳转：从SendCenterMsg命令跳转到QFunction-0.txt的对应标签
- 自定义按钮跳转：从ADDBUTTON命令跳转到QFunction-0.txt的按钮点击事件
- 任务脚本跳转：在MapQuest.txt中跳转到具体任务脚本文件
- 地图事件跳转：在Mapevent.txt中跳转到QFunction-0.txt的对应事件
- NPC脚本跳转：在Npcs.txt中跳转到具体NPC脚本文件
- @标签循环查找：在当前文件内循环跳转多个相同@标签，找不到时支持全局搜索

自动创建与模板功能
- 当目标文件不存在时，会询问是否创建并自动生成基础模板
- 支持自动创建NPC脚本、怪物爆率、任务脚本、定时器标签等各类文件

变量引用分析器 - 脚本变量追踪神器
全自动变量扫描
- 自动扫描MapQuest_Def、Market_Def、QuestDiary、Npc_Def、Robot_def等核心目录
- 支持GBK编码文件正确读取，完美兼容传奇引擎
- 进度条显示扫描过程，实时了解扫描进度

完整变量类型覆盖
- 基础变量：A、G、I、S、N、U、T、P、D、M、J、Z、B
- 系统变量：计时器(TIMER)、双击触发(Dc)、个人标识
- 扩展变量：S字符扩展、N数字扩展
- 自定义变量：自定义个人(HUMAN)、自定义全局(GLOBAL)

智能引用追踪
- 点击任意变量即可查看所有引用位置
- 引用结果以表格形式展示，包含文件路径、行号、代码内容
- 支持点击引用项快速跳转到对应文件行

树状结构展示
- 变量按类型分组显示，层次清晰
- 文件夹图标标识变量分类，符号图标标识具体变量
- 支持展开/折叠浏览，方便大型项目管理

颜色管理工具 - 脚本色彩可视化助手
颜色代码可视化
- 在FCOLOR=、SCOLOR=代码前显示彩色方块■
- 实时反映颜色编号对应的实际色彩
- 支持{AUTOCOLOR=250,251,252,253,254}多色渐变显示

智能颜色面板
- 10×10网格布局的颜色选择面板
- 每个颜色块显示编号和实际色彩
- 侧边栏打开，不占用编辑区域，保持编辑器焦点

智能代码插入与修改
- 智能识别：自动识别{FCOLOR=X}、{SCOLOR=X}、{AUTOCOLOR=...}格式
- 标签支持：识别<Text:内容:0:0>和<内容>格式的颜色代码
- 精确修改：在AUTOCOLOR中光标位置修改特定颜色
- 自动插入：无颜色代码时在行尾插入新的FCOLOR代码

实时全局搜索 - 全工程代码搜索引擎
全工程扫描
- 自动扫描工作区所有txt文件，排除.history等无关目录
- 支持GBK编码正确读取，完美兼容传奇脚本
- 进度条显示扫描进度，实时了解文件处理状态

实时搜索过滤
- 输入关键词即时过滤，无需等待
- 防抖处理避免频繁刷新，提升搜索体验
- 支持中文、英文、数字混合搜索

智能结果展示
- 表格形式展示文件路径、行号、代码内容
- 限制显示500条结果，避免界面卡顿
- 提示隐藏结果数量，确保信息完整

快速跳转定位
- 点击文件路径直接跳转到对应行
- 侧边栏打开搜索面板，不中断编辑工作流
- 保持搜索上下文，随时继续搜索任务

三合一数据库查看器 - 游戏数据管理平台
多数据库支持
- 物品数据库(StdItems)：ID、名称、类型(StdMode)
- 怪物数据库(Monster)：ID、名称、外观(Appr)
- 技能数据库(Magic)：ID、名称、职业(Job)

智能数据库识别
- 自动读取Config.ini配置，识别数据库类型
- 支持SQLite和Access数据库自动切换
- 自动定位数据库文件路径

强大的筛选搜索
- 实时搜索：按ID、名称即时过滤
- 分类筛选：物品按类型(武器、衣服、头盔等)筛选
- 职业筛选：技能按职业(战士、法师、道士、通用)筛选
- 状态保存：记住各数据库的筛选状态

便捷的数据插入
- 点击物品/怪物/技能名称直接插入到编辑器
- 自动处理名称格式，无需手动输入
- 显示插入成功提示，确认操作完成

智能代码辅助 - 编码效率提升套件
智能悬浮提示
- 鼠标悬停显示命令说明、参数格式
- 支持<$常量>、[@标签]、地图参数等提示
- 自动加载JSON配置，实时更新提示内容

智能代码补全
- 中英文命令自动补全，带参数占位符
- @变量自动提示，基于当前文档内容
- 双反引号快速插入代码模板

符号大全面板
- 12类特殊符号：箭头、几何、数学、序号、货币、假名、希腊字母等
- 分类浏览，一键插入到编辑器
- 在侧边栏打开，不占用编辑区域

?对话框坐标获取器 - 可视化界面设计工具
可视化设计界面
- 可视化拖拽定位对话框元素
- 实时预览对话框布局效果
- 自动生成GEE对话框代码

素材资源管理
- 支持自定义背景图片和素材
- 内置常用对话框素材库
- 记住用户配置，提升使用体验

精准坐标获取
- 实时显示鼠标坐标位置
- 支持对齐辅助线和网格
- 一键生成完整对话框代码

?NPC菜单重载工具 - 游戏服务器管理助手
智能窗口连接
- 自动查找M2Server.exe进程和游戏主窗口
- 支持窗口类名TFrmMain识别，精准定位
- 缓存机制提升连接速度，避免重复查找

菜单智能过滤
- 白名单机制：只显示相关功能菜单，过滤无关项
- 关键词匹配：物品数据、技能数据、怪物数据、QManage、QFunction等
- 自动清理：移除(&X)快捷键、Ctrl+字母等显示修饰

可视化菜单管理
- 图标分类：?控制菜单、?文件管理、?其他功能
- 层级显示：显示完整菜单路径控制 > 重新加载
- ID排序：按菜单ID排序，保持一致性

一键重载操作
- 脚本重载：QManage、QFunction、QMission、所有NPC
- 数据重载：物品数据、技能数据、怪物数据、怪物爆率
- Robot管理：Robot配置重载
- 即时反馈：显示执行结果和窗口连接状态

自动化工具集 - 智能开发工作流
自动重载系统
- 文件保存时自动重载对应脚本
- 支持QManage、QFunction、NPC、爆率等自动重载
- 防抖控制防止频繁重载
- 动态菜单索引匹配，适应不同服务器

文件树视图切换
- 精简模式：隐藏配置文件和生成文件
- 普通模式：显示所有文件
- 状态栏快速切换，优化项目浏览体验

常用文件快速打开
- 一键打开QManage、QFunction、MerChant等核心文件
- 智能路径定位，自动识别Mir200/Envir目录
- 覆盖脚本开发最常用的13个配置文件

大纲与导航 - 代码结构管理
大纲视图提供者
- 自动提取[标签]作为文档大纲
- 快速导航到脚本段落
- 支持所有txt文件的结构化浏览

智能折叠功能
- 自动识别[@标签]段落并提供折叠
- 一键折叠/展开所有代码段落
- 提升大文件浏览效率

?地图浏览器 - 地图可视化工具
地图查看功能
- 打开任意.map文件，侧边列出全部地图
- 阻挡图显示：绿色=可行走，深灰=障碍
- 支持滚轮缩放、拖拽移动地图视角
- 显示使用的Tiles、SmTiles、Objects及编号范围

地图编辑功能
- 直接修改「调用编号」「起始图片」
- 应用修改后自动更新地图文件
- 支持12/14/36字节格式自动识别，兼容老版本地图

使用场景覆盖

脚本开发：智能补全+悬浮提示+快速跳转  
界面设计：对话框可视化设计+颜色管理  
数据配置：数据库查看+变量分析  
项目管理：文件树优化+自动重载  
效率提升：符号库+代码模板+段落折叠  
实时调试：NPC菜单重载+全局搜索  
团队协作：大纲视图+统一编码规范

特色亮点

- 全链路覆盖：从代码编写到界面设计的完整工作流
- 智能上下文感知：根据编辑内容自动提供相关功能
- 可视化操作：减少记忆负担，提升配置效率
- 性能优化：缓存机制+防抖控制，确保流畅体验
- 无缝集成：所有功能深度集成到VSCode界面
- 实时交互：直接连接游戏服务器，实现边改边测
- 编码兼容：完美支持GBK编码，确保传奇引擎兼容性


常见问题

Q: 扩展安装后功能不生效？
A: 确认项目路径包含Mir200/Envir目录结构，根目录最好设置成Envir

Q: 一键重载连接失败？
A:确认M2Server.exe正在运行

Q: 数据库查看显示"加载中"？
A:确认Config.ini配置正确，数据库格式支持(SQLite/Access)
